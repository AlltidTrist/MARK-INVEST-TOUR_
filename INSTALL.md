# Инструкция по установке и настройке

## Установка зависимостей

```bash
npm install
```

## Настройка окружения

Создайте файл `.env` в корне проекта:

```env
PORT=3000
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
```

## Запуск сервера

### Режим разработки (с автоперезагрузкой)
```bash
npm run dev
```

### Режим продакшн
```bash
npm start
```

Сервер будет доступен по адресу: `http://localhost:3000`

## Доступ к админ-панели

1. Откройте в браузере: `http://localhost:3000/admin`
2. Войдите с учетными данными:
   - **Логин:** `admin`
   - **Пароль:** `admin123`

⚠️ **ВАЖНО:** Смените пароль после первого входа!

## Структура базы данных

База данных SQLite создается автоматически при первом запуске (`travel.db`).

### Таблицы:

1. **tours** - Туры
   - id, title, description, short_description, image_url, price, duration, location, date_start, date_end, max_participants, current_participants, status, created_at, updated_at

2. **applications** - Заявки с формы обратной связи
   - id, name, phone, email, direction, message, tour_id, status, created_at

3. **admins** - Администраторы
   - id, username, password, created_at

## API Endpoints

### Публичные (без авторизации):
- `GET /api/tours` - Получить все туры
- `GET /api/tours?status=active` - Получить только активные туры
- `GET /api/tours/:id` - Получить один тур
- `POST /api/applications` - Создать заявку (форма обратной связи)

### Защищенные (требуют JWT токен):
- `POST /api/auth/login` - Авторизация
- `POST /api/tours` - Создать тур
- `PUT /api/tours/:id` - Обновить тур
- `DELETE /api/tours/:id` - Удалить тур
- `GET /api/applications` - Получить все заявки
- `PUT /api/applications/:id/status` - Обновить статус заявки
- `GET /api/stats` - Получить статистику

## Использование

### Добавление туров через админ-панель

1. Войдите в админ-панель
2. Перейдите в раздел "Туры"
3. Нажмите "Добавить тур"
4. Заполните форму и загрузите изображение
5. Сохраните

### Просмотр заявок

1. В админ-панели перейдите в раздел "Заявки"
2. Просматривайте все заявки или фильтруйте по статусу
3. Отмечайте заявки как обработанные

### Интеграция формы на сайте

Форма обратной связи автоматически интегрирована. При отправке формы данные сохраняются в базу данных и отображаются в админ-панели.

## Изменение пароля администратора

Для изменения пароля администратора можно:

1. Использовать SQL запрос:
```sql
UPDATE admins SET password = '<новый_хеш_пароля>' WHERE username = 'admin';
```

2. Или создать скрипт для смены пароля (см. `scripts/change-password.js`)

## Резервное копирование

Регулярно делайте резервные копии файла `travel.db`:

```bash
cp travel.db travel.db.backup
```

## Troubleshooting

### Проблема: База данных не создается
- Убедитесь, что у приложения есть права на запись в директорию проекта

### Проблема: Изображения не загружаются
- Проверьте, что папка `assets/images/` существует и доступна для записи

### Проблема: Форма не отправляется
- Откройте консоль браузера (F12) и проверьте ошибки
- Убедитесь, что сервер запущен и доступен

