# Redis –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

## –û–ø–∏—Å–∞–Ω–∏–µ

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ API –æ—Ç–≤–µ—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Redis –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫—ç—à–∏—Ä—É–µ—Ç —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∫—ç—à –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Redis

### Windows
1. –°–∫–∞—á–∞–π—Ç–µ Redis –¥–ª—è Windows: https://github.com/microsoftarchive/redis/releases
2. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ WSL2 —Å Redis
3. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker: `docker run -d -p 6379:6379 redis:latest`

### Linux/Mac
```bash
# Ubuntu/Debian
sudo apt-get install redis-server

# macOS
brew install redis

# –ó–∞–ø—É—Å–∫
redis-server
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–î–æ–±–∞–≤—å—Ç–µ –≤ —Ñ–∞–π–ª `.env`:

```env
# URL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
REDIS_URL=redis://localhost:6379

# –û—Ç–∫–ª—é—á–∏—Ç—å Redis (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
# REDIS_ENABLED=false
```

## –ß—Ç–æ –∫—ç—à–∏—Ä—É–µ—Ç—Å—è

### 1. –°–ø–∏—Å–æ–∫ —Ç—É—Ä–æ–≤ (`GET /api/tours`)
- **TTL:** 5 –º–∏–Ω—É—Ç
- **–ö–ª—é—á:** `tours:{query_params}`
- –ö—ç—à–∏—Ä—É–µ—Ç—Å—è —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö query –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (status, search, dateFrom, –∏ —Ç.–¥.)

### 2. –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç—É—Ä–µ (`GET /api/tours/:id`)
- **TTL:** 10 –º–∏–Ω—É—Ç
- **–ö–ª—é—á:** `tour:{id}`

### 3. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç—É—Ä–∞ (`GET /api/tours/:id/images`)
- **TTL:** 30 –º–∏–Ω—É—Ç
- **–ö–ª—é—á:** `tour_images:{id}`

## –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞

–ö—ç—à –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏:

- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —Ç—É—Ä–∞ ‚Üí –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è –≤—Å–µ —Å–ø–∏—Å–∫–∏ —Ç—É—Ä–æ–≤
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç—É—Ä–∞ ‚Üí –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –∫—ç—à —ç—Ç–æ–≥–æ —Ç—É—Ä–∞ –∏ –≤—Å–µ—Ö —Å–ø–∏—Å–∫–æ–≤
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–∏ —Ç—É—Ä–∞ ‚Üí –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –∫—ç—à —ç—Ç–æ–≥–æ —Ç—É—Ä–∞ –∏ –≤—Å–µ—Ö —Å–ø–∏—Å–∫–æ–≤
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è ‚Üí –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –∫—ç—à –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —ç—Ç–æ–≥–æ —Ç—É—Ä–∞
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è ‚Üí –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –∫—ç—à –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —ç—Ç–æ–≥–æ —Ç—É—Ä–∞

## –†–∞–±–æ—Ç–∞ –±–µ–∑ Redis

–ï—Å–ª–∏ Redis –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ
- ‚úÖ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ –ë–î
- ‚ö†Ô∏è –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±—É–¥–µ—Ç –Ω–∏–∂–µ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–í –ª–æ–≥–∞—Ö –≤—ã —É–≤–∏–¥–∏—Ç–µ:
- `[INFO] –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Redis...` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
- `[INFO] Redis –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ` - Redis –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- `[DEBUG] Cache HIT: tours:all` - –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã –∏–∑ –∫—ç—à–∞
- `[DEBUG] Cache MISS: tour:123` - –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –≤ –∫—ç—à–µ, –∑–∞–ø—Ä–æ—Å –∫ –ë–î
- `[WARN] Redis –æ—Ç–∫–ª—é—á–µ–Ω —á–µ—Ä–µ–∑ REDIS_ENABLED=false` - Redis –æ—Ç–∫–ª—é—á–µ–Ω

## –†—É—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –∫—ç—à –≤—Ä—É—á–Ω—É—é:

```bash
redis-cli FLUSHALL
```

–ò–ª–∏ –æ—á–∏—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ –∫—ç—à —Ç—É—Ä–æ–≤:

```bash
redis-cli KEYS "tours:*" | xargs redis-cli DEL
redis-cli KEYS "tour:*" | xargs redis-cli DEL
redis-cli KEYS "tour_images:*" | xargs redis-cli DEL
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

–° –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º:
- ‚ö° –°–ø–∏—Å–æ–∫ —Ç—É—Ä–æ–≤: ~1-5ms (–≤–º–µ—Å—Ç–æ 50-200ms)
- ‚ö° –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: ~1-5ms (–≤–º–µ—Å—Ç–æ 30-100ms)
- ‚ö° –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: ~1-5ms (–≤–º–µ—Å—Ç–æ 20-80ms)

**–£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: 10-40x** üöÄ

