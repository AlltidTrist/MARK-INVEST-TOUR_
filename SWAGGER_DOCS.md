# Swagger API Документация

## Описание

В проекте реализована полная API документация с использованием Swagger/OpenAPI 3.0. Документация доступна в интерактивном формате через Swagger UI.

## Доступ к документации

После запуска сервера, документация доступна по адресу:

```
http://localhost:3000/api-docs
```

## Возможности

### 1. Просмотр всех API endpoints
- Все endpoints сгруппированы по тегам (Tours, Auth, Applications, и т.д.)
- Для каждого endpoint указаны:
  - HTTP метод и путь
  - Описание
  - Параметры запроса
  - Структура тела запроса
  - Примеры ответов
  - Коды ошибок

### 2. Интерактивное тестирование
- Можно отправлять запросы прямо из браузера
- Автоматическая валидация параметров
- Просмотр реальных ответов от API

### 3. Авторизация
- В Swagger UI есть кнопка "Authorize"
- Введите JWT токен, полученный при авторизации через `/api/auth/login`
- Токен будет автоматически добавляться ко всем защищенным запросам

## Использование

### 1. Получение токена авторизации

1. Откройте `/api-docs`
2. Найдите endpoint `POST /auth/login`
3. Нажмите "Try it out"
4. Введите данные:
   ```json
   {
     "username": "admin",
     "password": "admin123"
   }
   ```
5. Нажмите "Execute"
6. Скопируйте `token` из ответа

### 2. Авторизация в Swagger

1. Нажмите кнопку "Authorize" вверху страницы
2. В поле "Value" введите: `Bearer <ваш_токен>`
   Например: `Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...`
3. Нажмите "Authorize"
4. Теперь все защищенные endpoints будут использовать этот токен

### 3. Тестирование API

1. Выберите нужный endpoint
2. Нажмите "Try it out"
3. Заполните параметры (если требуется)
4. Нажмите "Execute"
5. Просмотрите ответ сервера

## Структура документации

### Теги (группы endpoints):

- **Tours** - Управление турами
- **Auth** - Авторизация и аутентификация
- **Applications** - Управление заявками
- **Subscriptions** - Управление подписками
- **Analytics** - Аналитика и статистика
- **Images** - Управление изображениями туров
- **Health** - Проверка работоспособности API

### Схемы данных:

Все основные сущности описаны в разделе "Schemas":
- `Tour` - Тур
- `Application` - Заявка
- `Subscription` - Подписка
- `AuthRequest` / `AuthResponse` - Авторизация
- `TourImage` - Изображение тура
- `Error` - Ошибка
- `SuccessMessage` - Успешный ответ

## Примеры использования

### Получить список активных туров

```http
GET /api/tours?status=active
```

### Создать новый тур (требует авторизации)

```http
POST /api/tours
Content-Type: multipart/form-data
Authorization: Bearer <token>

title: Тур в Австралию
price: 150000
status: active
image: <файл>
```

### Получить информацию о туре

```http
GET /api/tours/1
```

### Создать заявку

```http
POST /api/applications
Content-Type: application/json

{
  "name": "Иван Иванов",
  "phone": "+7 (999) 123-45-67",
  "email": "ivan@example.com",
  "direction": "Австралия",
  "message": "Хочу узнать больше о туре"
}
```

## Обновление документации

Документация автоматически обновляется при изменении Swagger аннотаций в файлах роутов (`server/routes/*.js`).

Для добавления нового endpoint:
1. Добавьте `@swagger` аннотацию перед роутом
2. Перезапустите сервер
3. Документация обновится автоматически

## Экспорт спецификации

Спецификация OpenAPI доступна в JSON формате:

```
http://localhost:3000/api-docs.json
```

Эту спецификацию можно использовать для:
- Генерации клиентских библиотек
- Импорта в Postman
- Использования в других инструментах

## Примечания

- Swagger UI работает только в браузере
- Для production рекомендуется ограничить доступ к `/api-docs`
- Все примеры в документации соответствуют реальному API

